{
  "setup":{
    "license":"Apache License, Version 2.0",
    "copyright":"Copyright 2019 Google Inc."
  },
  "tasks":[
    { "google_api":{
      "auth":"user",
      "api":"dfareporting",
      "version":"internalv3.3",
      "uri":"starthinker/util/dcm/internalv33_uri.json",
      "function":"reports.files.list",
      "kwargs":{
        "accountId": {"field":{ "name":"account_id", "kind":"string", "default":"" }},
        "profileId": {"field":{ "name":"profile_id", "kind":"string", "default":"" }},
        "reportId": {"field":{ "name":"report_id", "kind":"string", "default":"" }}
      },
      "iterate":true,
      "out": {
        "bigquery":{
          "dataset":"Test",
          "table":"API_DCM_Report",
          "format":"JSON"
        }
      }
    }},
    { "test": {
      "auth":"user",
      "bigquery":{
        "dataset":"Test",
        "table":"API_DCM_Report",
        "schema": [
          {"mode": "NULLABLE", "name": "format", "type": "STRING"},
          {"mode": "NULLABLE", "name": "reportId", "type": "INTEGER"},
          {"mode": "NULLABLE", "name": "id", "type": "INTEGER"},
          {"mode": "NULLABLE", "name": "fileName", "type": "STRING"},
          {"mode": "NULLABLE", "name": "etag", "type": "STRING"},
          {"fields": [
            {"mode": "NULLABLE", "name": "endDate", "type": "DATE"},
            {"mode": "NULLABLE", "name": "kind", "type": "STRING"},
            {"mode": "NULLABLE", "name": "startDate", "type": "DATE"}
           ],
           "mode": "NULLABLE",
           "name": "dateRange",
           "type": "RECORD"
          },
          {"fields": [
            {"mode": "NULLABLE", "name": "apiUrl", "type": "STRING"},
            {"mode": "NULLABLE", "name": "browserUrl", "type": "STRING"}
           ],
           "mode": "NULLABLE",
           "name": "urls",
           "type": "RECORD"},
          {"mode": "NULLABLE", "name": "kind", "type": "STRING"},
          {"mode": "NULLABLE", "name": "lastModifiedTime", "type": "INTEGER"},
          {"mode": "NULLABLE", "name": "status", "type": "STRING"}
        ]
      }
    }}
  ]
}
