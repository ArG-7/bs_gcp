###########################################################################
# 
#  Copyright 2019 Google Inc.
#
#  Licensed under the Apache License, Version 2.0 (the "License");
#  you may not use this file except in compliance with the License.
#  You may obtain a copy of the License at
#
#      https://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.
#
###########################################################################

'''
Bulkdozer

Bulkdozer is a tool that can reduce trafficking time in Campaign Manager by up to 80%% by providing automated bulk editing capabilities.

O
p
e
n
 
t
h
e
 
<
a
 
h
r
e
f
=
'
h
t
t
p
s
:
/
/
d
o
c
s
.
g
o
o
g
l
e
.
c
o
m
/
s
p
r
e
a
d
s
h
e
e
t
s
/
d
/
1
h
L
r
p
s
a
p
X
Y
5
j
s
b
g
Q
R
c
S
p
j
H
0
4
a
v
v
d
c
o
r
t
u
f
I
0
O
X
S
J
Z
Q
H
8
'
 
t
a
r
g
e
t
=
'
_
b
l
a
n
k
'
>
B
u
l
k
d
o
z
e
r
 
0
.
2
3
<
/
a
>
 
f
e
e
d
.


M
a
k
e
 
y
o
u
r
 
o
w
n
 
c
o
p
y
 
o
f
 
t
h
e
 
f
e
e
d
 
b
y
 
c
l
i
c
k
i
n
g
 
t
h
e
 
F
i
l
e
 
-
>
 
M
a
k
e
 
a
 
c
o
p
y
.
.
.
 
m
e
n
u
 
i
n
 
t
h
e
 
f
e
e
d
.


G
i
v
e
 
i
t
 
a
 
m
e
a
n
i
n
f
u
l
 
n
a
m
e
 
i
n
c
l
u
d
i
n
g
 
t
h
e
 
v
e
r
s
i
o
n
,
 
y
o
u
r
 
n
a
m
e
,
 
a
n
d
 
t
e
a
m
 
t
o
 
h
e
l
p
 
y
o
u
 
i
d
e
n
t
i
f
y
 
i
t
 
a
n
d
 
e
n
s
u
r
e
 
y
o
u
 
a
r
e
 
u
s
i
n
g
 
t
h
e
 
c
o
r
r
e
c
t
 
v
e
r
s
i
o
n
.


U
n
d
e
r
 
t
h
e
 
A
c
c
o
u
n
t
 
I
D
 
f
i
e
l
d
 
b
e
l
o
w
,
 
e
n
t
e
r
 
t
h
e
 
y
o
u
r
 
C
a
m
p
a
i
g
n
 
M
a
n
a
g
e
r
 
N
e
t
w
o
r
k
 
I
D
.


U
n
d
e
r
 
S
h
e
e
t
 
U
R
L
,
 
e
n
t
e
r
 
t
h
e
 
U
R
L
 
o
f
 
y
o
u
r
 
c
o
p
y
 
o
f
 
t
h
e
 
f
e
e
d
 
t
h
a
t
 
y
o
u
 
j
u
s
t
 
c
r
e
a
t
e
d
 
i
n
 
t
h
e
 
s
t
e
p
s
 
a
b
o
v
e
.


G
o
 
t
o
 
t
h
e
 
S
t
o
r
e
 
t
a
b
 
o
f
 
y
o
u
r
 
n
e
w
 
f
e
e
d
,
 
a
n
d
 
e
n
t
e
r
 
y
o
u
r
 
p
r
o
f
i
l
e
 
I
D
 
i
n
 
t
h
e
 
p
r
o
f
i
l
e
I
d
 
f
i
e
l
d
 
(
c
e
l
l
 
B
2
)
.
 
Y
o
u
r
 
p
r
o
f
i
l
e
 
I
D
 
i
s
 
v
i
s
i
b
l
e
 
i
n
 
C
a
m
p
a
i
g
n
 
M
a
n
a
g
e
r
 
b
y
 
c
l
i
c
k
i
n
g
 
y
o
u
r
 
a
v
a
t
a
r
 
o
n
 
t
h
e
 
t
o
p
 
r
i
g
h
t
 
c
o
r
n
e
r
.


C
l
i
c
k
 
t
h
e
 
'
S
a
v
e
'
 
b
u
t
t
o
n
 
b
e
l
o
w
.


A
f
t
e
r
 
c
l
i
c
k
i
n
g
 
'
S
a
v
e
'
,
 
c
o
p
y
 
t
h
i
s
 
p
a
g
e
'
s
 
U
R
L
 
f
r
o
m
 
y
o
u
r
 
b
r
o
w
s
e
r
 
a
d
d
r
e
s
s
 
b
a
r
,
 
a
n
d
 
p
a
s
t
e
 
i
t
 
i
n
 
t
h
e
 
S
t
o
r
e
 
t
a
b
 
f
o
r
 
t
h
e
 
r
e
c
i
p
e
_
u
r
l
 
f
i
e
l
d
 
(
c
e
l
l
 
B
5
)
 
y
o
u
r
 
s
h
e
e
t
.


B
u
l
k
d
o
z
e
r
 
i
s
 
r
e
a
d
y
 
f
o
r
 
u
s
e


S
t
a
y
 
u
p
 
t
o
 
d
a
t
e
 
o
n
 
n
e
w
 
r
e
l
e
a
s
e
s
 
a
n
d
 
o
t
h
e
r
 
g
e
n
e
r
a
l
 
a
n
o
u
n
c
e
m
e
n
t
s
 
b
y
 
j
o
i
n
i
n
g
 
<
a
 
h
r
e
f
=
'
h
t
t
p
s
:
/
/
g
r
o
u
p
s
.
g
o
o
g
l
e
.
c
o
m
/
f
o
r
u
m
/
#
!
f
o
r
u
m
/
b
u
l
k
d
o
z
e
r
-
a
n
n
o
u
n
c
e
m
e
n
t
s
'
 
t
a
r
g
e
t
=
'
_
b
l
a
n
k
'
>
B
u
l
k
d
o
z
e
r
 
a
n
n
o
u
n
c
e
m
e
n
t
s
<
/
a
>
.


R
e
v
i
e
w
 
t
h
e
 
<
a
 
h
r
e
f
=
'
h
t
t
p
s
:
/
/
g
i
t
h
u
b
.
c
o
m
/
g
o
o
g
l
e
/
s
t
a
r
t
h
i
n
k
e
r
/
b
l
o
b
/
m
a
s
t
e
r
/
t
u
t
o
r
i
a
l
s
/
B
u
l
k
d
o
z
e
r
/
I
n
s
t
a
l
l
a
t
i
o
n
_
a
n
d
_
U
s
e
r
_
g
u
i
d
e
s
.
m
d
'
 
t
a
r
g
e
t
=
'
_
b
l
a
n
k
'
>
B
u
l
k
d
o
z
e
r
 
d
o
c
u
m
e
n
t
a
t
i
o
n
<
/
a
>
.

'''

from starthinker_airflow.factory import DAG_Factory
 
USER_CONN_ID = "google_cloud_default" # The connection to use for user authentication.
GCP_CONN_ID = "" # The connection to use for service authentication.

INPUTS = {
  'recipe_timezone': 'America/Chicago',  # Timezone for report dates.
  'account_id': '',  # Campaign Manager Network ID (optional if profile id provided)
  'dcm_profile_id': '',  # Campaign Manager Profile ID (optional if account id provided)
  'sheet_url': '',  # Feed Sheet URL
}

TASKS = [
  {
    'traffic': {
      'hour': [
      ],
      'account_id': {
        'field': {
          'name': 'account_id',
          'kind': 'string',
          'order': 1,
          'description': 'Campaign Manager Network ID (optional if profile id provided)',
          'default': ''
        }
      },
      'dcm_profile_id': {
        'field': {
          'name': 'dcm_profile_id',
          'kind': 'string',
          'order': 1,
          'description': 'Campaign Manager Profile ID (optional if account id provided)',
          'default': ''
        }
      },
      'auth': 'user',
      'sheet_url': {
        'field': {
          'name': 'sheet_url',
          'kind': 'string',
          'order': 2,
          'description': 'Feed Sheet URL',
          'default': ''
        }
      },
      'timezone': {
        'field': {
          'name': 'recipe_timezone',
          'kind': 'timezone',
          'description': 'Timezone for report dates.',
          'default': 'America/Chicago'
        }
      }
    }
  }
]

DAG_FACTORY = DAG_Factory('bulkdozer', { 'tasks':TASKS }, INPUTS)
DAG_FACTORY.apply_credentails(USER_CONN_ID, GCP_CONN_ID)
DAG = DAG_FACTORY.execute()

if __name__ == "__main__":
  DAG_FACTORY.print_commandline()
